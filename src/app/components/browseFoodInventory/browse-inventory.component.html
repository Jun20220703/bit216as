<div class="layout">
  <!-- Sidebar -->
  <app-sidebar></app-sidebar>

  <!-- Main content -->
  <div class="content">
    <!-- Header -->
    <header class="inventory-header">
      <div class="inventory-title">
        <label>Inventory</label>
        <div class="select-wrapper">
          <select [(ngModel)]="selectedLocation">
            <option *ngFor="let loc of locations">{{ loc }}</option>
          </select>
          <span class="custom-arrow">â–¼</span>
        </div>
      </div>

      <div class="header-icons">
        <!-- Search Icon -->
        <i class="fa-solid fa-magnifying-glass header-icon" (click)="toggleSearchBar()"></i>

        <!-- Filter Icon -->
        <i class="fa-solid fa-sliders header-icon" (click)="toggleFilterPanel()"></i>
      </div>
    </header>

    <!-- Search bar -->
    <div *ngIf="showSearch" class="search-bar">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        placeholder="Search food items..."
      />
    </div>

    <!-- Filter panel -->
    <div *ngIf="showFilter" class="filter-panel">
      <!-- Source Section -->
      <div class="filter-section">
        <h3>Source</h3>
        <label>
          <input type="radio" name="source" [checked]="filter.inventory" (change)="toggleSource('inventory')" />
          Inventory only
        </label>
        <label>
          <input type="radio" name="source" [checked]="filter.donation" (change)="toggleSource('donation')" />
          Donation List
        </label>
      </div>

      <!-- Category Section -->
      <div class="filter-section">
        <h3>Category</h3>
        <label>
          <input type="checkbox" [checked]="filter.categories.all" (change)="toggleCategory('all')" /> All
        </label>
        <label>
          <input type="checkbox" [checked]="filter.categories.fruit" (change)="toggleCategory('fruit')" /> Fruit
        </label>
        <label>
          <input type="checkbox" [checked]="filter.categories.vegetable" (change)="toggleCategory('vegetable')" /> Vegetable
        </label>
        <label>
          <input type="checkbox" [checked]="filter.categories.meat" (change)="toggleCategory('meat')" /> Meal
        </label>
      </div>

      <!-- Expired Section -->
      <div class="filter-section">
        <h3>Expired in</h3>
        <input type="number" [(ngModel)]="filter.expiredIn" />
      </div>
    </div>

    <!-- Category list -->
    <div
      *ngFor="let category of filteredCategories()"
      class="category"
      [ngClass]="category.colorClass"
    >
      <h2>{{ category.icon }} {{ category.name }}</h2>

      <div
        *ngFor="let item of category.items"
        class="item"
        (mouseenter)="hoverItem = item"
        (mouseleave)="hoverItem = null"
      >
        <span class="item-name">{{ item.name }}</span>

        <div class="actions">
          <div class="quantity-control">
            <button (click)="decreaseItem(item)">-</button>
            <span>{{ item.quantity }}</span>
            <button (click)="increaseItem(item)">+</button>
          </div>

          <div class="hover-actions" *ngIf="hoverItem === item">
            <button class="used">Used</button>
            <button class="meal">Meal</button>
            <button class="donate">Donate</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
